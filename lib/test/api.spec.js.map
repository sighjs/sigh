{"version":3,"sources":["../../src/test/api.spec.js"],"names":[],"mappings":";;;;wBAAoB,UAAU;;;;gCAKD,qBAAqB;;;;mBAClB,QAAQ;;AAJxC,IAAI,IAAI,GAAG,sBAAQ,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,CAAA;AACtD,IAAI,QAAQ,GAAG,sBAAQ,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAA;;AAKvD,IAAI,YAAY,GAAG,4BAA4B,CAAA;;AAE/C,QAAQ,CAAC,KAAK,EAAE,YAAM;AACpB,IAAE,CAAC,2EAA2E,EAAE,YAAW;AACzF,QAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;;AAElB,QAAI,UAAU,EAAE,QAAQ,EAAE,OAAO,CAAA;;AAEjC,WAAO,QAAQ,CAAC,EAAE,GAAG,EAAE,UAAU,EAAE,MAAM,EAAE,gBAAgB,EAAE,CAAC,CAC7D,IAAI,CAAC,UAAA,QAAQ,EAAI;AAChB,aAAO,GAAG,QAAQ,CAAA;AAClB,aAAO,IAAI,CAAC,YAAY,EAAE,OAAO,CAAC,CAAA;KACnC,CAAC,CACD,IAAI,CAAC,YAAM;AACV,gBAAU,GAAG,OAAO,CAAC,GAAG,EAAE,CAAA;AAC1B,aAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAA;;AAEtB,UAAI,IAAI,GAAG,EAAE,WAAW,EAAE,YAAY,EAAE,CAAA;AACxC,cAAQ,GAAG,kCAAqB,IAAI,CAAC,CAAA;AACrC,aAAO,0BAAgB,QAAQ,EAAE,IAAI,CAAC,CAAA;KACvC,CAAC,CACD,IAAI,CAAC,UAAA,OAAO;aAAI,OAAO,CAAC,EAAE,CAAC,SAAS,uBAAS;KAAA,CAAC,CAC9C,IAAI,CAAC,UAAA,MAAM,EAAI;AACd,YAAM,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;AAC7B,UAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAA;AACrB,WAAK,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAA;KAC5C,CAAC,WACM,CAAC,YAAM;AACb,cAAQ,CAAC,OAAO,EAAE,CAAA;AAClB,UAAI,UAAU,EACZ,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAA;KAC5B,CAAC,CAAA;GACH,CAAC,CAAA;CACH,CAAC,CAAA","file":"src/test/api.spec.js","sourcesContent":["import Promise from 'bluebird'\n\nvar copy = Promise.promisify(require('fs-extra').copy)\nvar mkTmpDir = Promise.promisify(require('temp').mkdir)\n\nimport PipelineCompiler from '../PipelineCompiler'\nimport { compileSighfile } from '../api'\n\nvar FIXTURE_PATH = 'test/fixtures/sigh-project'\n\ndescribe('api', () => {\n  it('compile should build working bacon streams from pipelines in Sigh.js file', function() {\n    this.timeout(3000)\n\n    var pathBackup, compiler, tmpPath\n\n    return mkTmpDir({ dir: 'test/tmp', prefix: 'sigh-api-test-' })\n    .then(_tmpPath => {\n      tmpPath = _tmpPath\n      return copy(FIXTURE_PATH, tmpPath)\n    })\n    .then(() => {\n      pathBackup = process.cwd()\n      process.chdir(tmpPath)\n\n      var opts = { environment: 'production' }\n      compiler = new PipelineCompiler(opts)\n      return compileSighfile(compiler, opts)\n    })\n    .then(streams => streams.js.toPromise(Promise))\n    .then(events => {\n      events.length.should.equal(1)\n      var event = events[0]\n      event.path.should.equal('dist/combined.js')\n    })\n    .finally(() => {\n      compiler.destroy()\n      if (pathBackup)\n        process.chdir(pathBackup)\n    })\n  })\n})\n"]}
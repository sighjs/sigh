{"version":3,"sources":["../../../src/test/plugin/concat.spec.js"],"names":[],"mappings":";;;;sBAAc,QAAQ;;;;wBACF,UAAU;;;;wBACD,WAAW;;4BAErB,qBAAqB;;;;yBACN,YAAY;;sBACpB,UAAU;;AAEpC,QAAQ,CAAC,eAAe,EAAE,YAAM;AAC9B,IAAE,CAAC,qCAAqC,EAAE,YAAM;AAC9C,QAAI,MAAM,GAAG,gBAAM,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,UAAA,GAAG;aAAI,uBAAU,GAAG,CAAC;KAAA,CAAC,CAAC,CAAA;;AAEjE,WAAO,+BAAO,EAAE,MAAM,EAAN,MAAM,EAAE,EAAE,WAAW,EAAE,EAAE,CAAC,CAAC,SAAS,uBAAS,CAAC,IAAI,CAAC,UAAA,MAAM,EAAI;AAC3E,YAAM,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;sBACH,MAAM,CAAC,CAAC,CAAC;UAA7B,IAAI,aAAJ,IAAI;UAAE,SAAS,aAAT,SAAS;;AACrB,UAAI,CAAC,MAAM,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAA;;AAEzD,UAAI,QAAQ,GAAG,iCAAsB,SAAS,CAAC,CAAA;AAC/C,UAAI,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,UAAA,IAAI;eAAI,QAAQ,CAAC,mBAAmB,CAAC,EAAE,IAAI,EAAJ,IAAI,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC;OAAA,CAAC,CAAA;AACrF,YAAM,CAAC,OAAO,CAAC,UAAC,GAAG,EAAE,GAAG,EAAK;AAC3B,WAAG,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;AACxB,WAAG,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,WAAQ,GAAG,GAAG,CAAC,CAAA,SAAM,CAAA;OAC7C,CAAC,CAAA;KACH,CAAC,CAAA;GACH,CAAC,CAAA;;AAEF,IAAE,CAAC,2BAA2B,EAAE,YAAM;AACpC,QAAI,MAAM,GAAG,gBAAM,SAAS,CAAC,CAC3B,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,UAAA,GAAG;aAAI,uBAAU,GAAG,CAAC;KAAA,CAAC,CAClC,CAAC,CAAA;;;AAEF,WAAO,+BAAO,EAAE,MAAM,EAAN,MAAM,EAAE,EAAE,WAAW,EAAE,EAAE,CAAC,CAAC,SAAS,uBAAS,CAAC,IAAI,CAAC,UAAA,MAAM,EAAI;AAC3E,YAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAA;KACxD,CAAC,CAAA;GACH,CAAC,CAAA;;AAEF,IAAE,CAAC,mDAAmD,EAAE,YAAM;AAC5D,QAAM,IAAI,GAAG,oBAAoB,CAAA;;AAEjC,QAAM,KAAK,GAAG,oBAAU;AACtB,cAAQ,EAAE,MAAM;AAChB,UAAI,EAAE,uBAAuB;AAC7B,UAAI,EAAE,KAAK;AACX,UAAI,EAAJ,IAAI;KACL,CAAC,CAAA;;AAEF,QAAM,MAAM,GAAG,gBAAM,QAAQ,CAAC,CAAE,KAAK,CAAE,CAAC,CAAA;;AAExC,WAAO,+BAAO,EAAE,MAAM,EAAN,MAAM,EAAE,CAAC,CAAC,SAAS,uBAAS,CAAC,IAAI,CAAC,UAAA,MAAM,EAAI;AAC1D,YAAM,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KACrD,CAAC,CAAA;GACH,CAAC,CAAA;;AAEF,KAAG,CAAC,oEAAoE,EAAE,YAAM,EAC/E,CAAC,CAAA;CACH,CAAC,CAAA","file":"concat.spec.js","sourcesContent":["import _ from 'lodash'\nimport Promise from 'bluebird'\nimport { Bacon, Event } from 'sigh-core'\n\nimport concat from '../../plugin/concat'\nimport { SourceMapConsumer } from 'source-map'\nimport { makeEvent } from './helper'\n\ndescribe('concat plugin', () => {\n  it('concatenates three javascript files', () => {\n    var stream = Bacon.constant([1, 2, 3].map(num => makeEvent(num)))\n\n    return concat({ stream }, 'output.js', 10).toPromise(Promise).then(events => {\n      events.length.should.equal(1)\n      var { data, sourceMap } = events[0]\n      data.should.equal('var a1 = 1\\nvar a2 = 2\\nvar a3 = 3\\n')\n\n      var consumer = new SourceMapConsumer(sourceMap)\n      var varPos = [1, 2, 3].map(line => consumer.originalPositionFor({ line, column: 0 }))\n      varPos.forEach((pos, idx) => {\n        pos.line.should.equal(1)\n        pos.source.should.equal(`file${idx + 1}.js`)\n      })\n    })\n  })\n\n  it('preserves treeIndex order', () => {\n    var stream = Bacon.fromArray([\n      [2, 1].map(num => makeEvent(num)), // first file in event array has higher tree index\n    ])\n\n    return concat({ stream }, 'output.js', 10).toPromise(Promise).then(events => {\n      events[0].data.should.equal('var a1 = 1\\nvar a2 = 2\\n')\n    })\n  })\n\n  it('should handle erroneous js file without sourcemap', () => {\n    const data = \"console.log('test)\"\n\n    const event = new Event({\n      basePath: 'root',\n      path: 'root/subdir/output.js',\n      type: 'add',\n      data\n    })\n\n    const stream = Bacon.constant([ event ])\n\n    return concat({ stream }).toPromise(Promise).then(events => {\n      events[0]._sourceMap.sources.length.should.equal(0);\n    })\n  })\n\n  xit('strips source map comments when concatenating two javascript files', () => {\n  })\n})\n"]}
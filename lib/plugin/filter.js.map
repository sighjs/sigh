{"version":3,"sources":["../../src/plugin/filter.js"],"names":[],"mappings":";;;;;;;;sBAAc,QAAQ;;;;wBACA,WAAW;;qBAElB,UAAS,MAAM,EAAE,EAAE,EAAc;oCAAT,OAAO;AAAP,WAAO;;;AAC5C,SAAO,GAAG,oBAAE,OAAO,CAAC,OAAO,CAAC,CAAA;;AAE5B,SAAO,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,MAAM,EAAI;;AAEjC,QAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EACrB,OAAO,EAAE,CAAA;;AAEX,UAAM,GAAG,MAAM,CAAC,MAAM,CAAC,UAAA,KAAK,EAAI;AAC9B,aAAO,OAAO,CAAC,IAAI,CAAC,UAAA,MAAM,EAAI;AAC5B,aAAK,IAAI,GAAG,IAAI,MAAM,EAAE;AACtB,cAAI,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;AAC3B,cAAI,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAA;AACtB,cAAI,SAAS,YAAY,MAAM,EAAE;AAC/B,gBAAI,CAAE,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,EACzB,OAAO,IAAI,CAAA;WACd,MACI,IAAI,SAAS,KAAK,KAAK,EAC1B,OAAO,IAAI,CAAA;SACd;;AAED,eAAO,KAAK,CAAA;OACb,CAAC,GAAI,CAAE,MAAM,GAAI,MAAM,CAAA;KACzB,CAAC,CAAA;;AAEF,WAAO,MAAM,CAAC,MAAM,KAAK,CAAC,GAAG,gBAAM,KAAK,EAAE,GAAG,MAAM,CAAA;GACpD,CAAC,CAAA;CACH","file":"filter.js","sourcesContent":["import _ from 'lodash'\nimport { Bacon } from 'sigh-core'\n\nexport default function(select, op, ...filters) {\n  filters = _.flatten(filters)\n\n  return op.stream.flatMap(events => {\n    // ensure initialisation events are forwarded\n    if (events.length === 0)\n      return []\n\n    events = events.filter(event => {\n      return filters.some(filter => {\n        for (var key in filter) {\n          var keyFilter = filter[key]\n          var value = event[key]\n          if (keyFilter instanceof RegExp) {\n            if (! keyFilter.test(value))\n              return true\n          }\n          else if (keyFilter !== value)\n            return true\n        }\n\n        return false\n      }) ? (! select) : select\n    })\n\n    return events.length === 0 ? Bacon.never() : events\n  })\n}\n"]}